<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QSMP: Quantum Secure Messaging Protocol: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSMP/QSMP/server.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="qsmp_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">QSMP: Quantum Secure Messaging Protocol<span id="projectnumber">&#160;1.3.0.0a (A3)</span>
   </div>
   <div id="projectbrief">A quantum secure encrypted tunneling protocol</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('server_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">server.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>QSMP Server functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="qsmp_8h_source.html">qsmp.h</a>&quot;</code><br />
<code>#include &quot;../../QSC/QSC/rcs.h&quot;</code><br />
<code>#include &quot;../../QSC/QSC/socketserver.h&quot;</code><br />
</div>
<p><a href="server_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1c917236984d53085480f3feed380d2c" id="r_a1c917236984d53085480f3feed380d2c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1c917236984d53085480f3feed380d2c">QSMP_SERVER_PAUSE_INTERVAL</a>&#160;&#160;&#160;100</td></tr>
<tr class="memdesc:a1c917236984d53085480f3feed380d2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The pause interval used by the server pause function.  <br /></td></tr>
<tr class="separator:a1c917236984d53085480f3feed380d2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abc91de3735de0dd7533239d8ca5ff844" id="r_abc91de3735de0dd7533239d8ca5ff844"><td class="memItemLeft" align="right" valign="top">QSMP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abc91de3735de0dd7533239d8ca5ff844">qsmp_server_broadcast</a> (const uint8_t *message, size_t msglen)</td></tr>
<tr class="memdesc:abc91de3735de0dd7533239d8ca5ff844"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broadcast a message to all connected hosts.  <br /></td></tr>
<tr class="separator:abc91de3735de0dd7533239d8ca5ff844"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a300ff9410ccb72fd9733d262ff647e36" id="r_a300ff9410ccb72fd9733d262ff647e36"><td class="memItemLeft" align="right" valign="top">QSMP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a300ff9410ccb72fd9733d262ff647e36">qsmp_server_pause</a> (void)</td></tr>
<tr class="memdesc:a300ff9410ccb72fd9733d262ff647e36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pause the server.  <br /></td></tr>
<tr class="separator:a300ff9410ccb72fd9733d262ff647e36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee4028fe4c50e92d29282df8b5079a7f" id="r_aee4028fe4c50e92d29282df8b5079a7f"><td class="memItemLeft" align="right" valign="top">QSMP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aee4028fe4c50e92d29282df8b5079a7f">qsmp_server_quit</a> (void)</td></tr>
<tr class="memdesc:aee4028fe4c50e92d29282df8b5079a7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Quit the server.  <br /></td></tr>
<tr class="separator:aee4028fe4c50e92d29282df8b5079a7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14dc3f40667db595a07d419da696c55d" id="r_a14dc3f40667db595a07d419da696c55d"><td class="memItemLeft" align="right" valign="top">QSMP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a14dc3f40667db595a07d419da696c55d">qsmp_server_resume</a> (void)</td></tr>
<tr class="memdesc:a14dc3f40667db595a07d419da696c55d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resume the server listener.  <br /></td></tr>
<tr class="separator:a14dc3f40667db595a07d419da696c55d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e986cf714c5489b31182d0894902827" id="r_a8e986cf714c5489b31182d0894902827"><td class="memItemLeft" align="right" valign="top">QSMP_EXPORT_API <a class="el" href="qsmp_8h.html#a558f889f6d19c213d49a646d3f733ffd">qsmp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8e986cf714c5489b31182d0894902827">qsmp_server_start_ipv4</a> (qsc_socket *source, const <a class="el" href="structqsmp__server__signature__key.html">qsmp_server_signature_key</a> *kset, void(*receive_callback)(<a class="el" href="structqsmp__connection__state.html">qsmp_connection_state</a> *, const uint8_t *, size_t), void(*disconnect_callback)(<a class="el" href="structqsmp__connection__state.html">qsmp_connection_state</a> *))</td></tr>
<tr class="memdesc:a8e986cf714c5489b31182d0894902827"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the IPv4 multi-threaded server.  <br /></td></tr>
<tr class="separator:a8e986cf714c5489b31182d0894902827"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b1c9dce9b1ecd503785ba6f440e1f8f" id="r_a4b1c9dce9b1ecd503785ba6f440e1f8f"><td class="memItemLeft" align="right" valign="top">QSMP_EXPORT_API <a class="el" href="qsmp_8h.html#a558f889f6d19c213d49a646d3f733ffd">qsmp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4b1c9dce9b1ecd503785ba6f440e1f8f">qsmp_server_start_ipv6</a> (qsc_socket *source, const <a class="el" href="structqsmp__server__signature__key.html">qsmp_server_signature_key</a> *kset, void(*receive_callback)(<a class="el" href="structqsmp__connection__state.html">qsmp_connection_state</a> *, const uint8_t *, size_t), void(*disconnect_callback)(<a class="el" href="structqsmp__connection__state.html">qsmp_connection_state</a> *))</td></tr>
<tr class="memdesc:a4b1c9dce9b1ecd503785ba6f440e1f8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the IPv6 multi-threaded server.  <br /></td></tr>
<tr class="separator:a4b1c9dce9b1ecd503785ba6f440e1f8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>QSMP Server functions. </p>
<p>This header declares the functions used to implement the server component of the Quantum Secure Messaging Protocol (QSMP). The server functions manage client connections, broadcast messages, and control the server lifecycle through operations such as pausing, resuming, and quitting. QSMP employs a multi-threaded server design that supports both IPv4 and IPv6 connections.</p>
<p>The functions provided in this header include:</p><ul>
<li>Broadcasting a message to all connected hosts.</li>
<li>Pausing the server to suspend acceptance of new connections.</li>
<li>Quitting the server by closing all active connections.</li>
<li>Resuming the server listener from a paused state.</li>
<li>Starting the multi-threaded server on IPv4 and IPv6 interfaces with support for callback functions to process incoming data and handle disconnect events.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>QSMP_EXPORT_API is used to ensure proper symbol visibility. </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a1c917236984d53085480f3feed380d2c" name="a1c917236984d53085480f3feed380d2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c917236984d53085480f3feed380d2c">&#9670;&#160;</a></span>QSMP_SERVER_PAUSE_INTERVAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define QSMP_SERVER_PAUSE_INTERVAL&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The pause interval used by the server pause function. </p>
<p>This macro defines the time interval (in milliseconds) that the server will pause before resuming operations or processing new connection requests. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="abc91de3735de0dd7533239d8ca5ff844" name="abc91de3735de0dd7533239d8ca5ff844"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc91de3735de0dd7533239d8ca5ff844">&#9670;&#160;</a></span>qsmp_server_broadcast()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QSMP_EXPORT_API void qsmp_server_broadcast </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>message</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>msglen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Broadcast a message to all connected hosts. </p>
<p>This function iterates over all active connections managed by the server and transmits the specified message to each connected host. It is useful for disseminating announcements or control messages across the network.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>[const] A pointer to the message data to be broadcast. </td></tr>
    <tr><td class="paramname">msglen</td><td>The length (in bytes) of the message.</td></tr>
  </table>
  </dd>
</dl>
<p>DOXYGEN_IGNORE DOXYGEN_IGNORE </p>

</div>
</div>
<a id="a300ff9410ccb72fd9733d262ff647e36" name="a300ff9410ccb72fd9733d262ff647e36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a300ff9410ccb72fd9733d262ff647e36">&#9670;&#160;</a></span>qsmp_server_pause()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QSMP_EXPORT_API void qsmp_server_pause </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pause the server. </p>
<p>This function temporarily suspends the acceptance of new client connections. While paused, the server continues to service existing connections but does not allow any new joins until it is resumed. </p>

</div>
</div>
<a id="aee4028fe4c50e92d29282df8b5079a7f" name="aee4028fe4c50e92d29282df8b5079a7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee4028fe4c50e92d29282df8b5079a7f">&#9670;&#160;</a></span>qsmp_server_quit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QSMP_EXPORT_API void qsmp_server_quit </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Quit the server. </p>
<p>This function gracefully shuts down the server by closing all active client connections and terminating the server's listener. It is used to perform a complete shutdown of the server operations. </p>

</div>
</div>
<a id="a14dc3f40667db595a07d419da696c55d" name="a14dc3f40667db595a07d419da696c55d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14dc3f40667db595a07d419da696c55d">&#9670;&#160;</a></span>qsmp_server_resume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QSMP_EXPORT_API void qsmp_server_resume </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resume the server listener. </p>
<p>This function resumes the server's listener functionality after it has been paused. Once resumed, the server will once again accept new incoming client connections. </p>

</div>
</div>
<a id="a8e986cf714c5489b31182d0894902827" name="a8e986cf714c5489b31182d0894902827"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e986cf714c5489b31182d0894902827">&#9670;&#160;</a></span>qsmp_server_start_ipv4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QSMP_EXPORT_API <a class="el" href="qsmp_8h.html#a558f889f6d19c213d49a646d3f733ffd">qsmp_errors</a> qsmp_server_start_ipv4 </td>
          <td>(</td>
          <td class="paramtype">qsc_socket *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structqsmp__server__signature__key.html">qsmp_server_signature_key</a> *</td>          <td class="paramname"><span class="paramname"><em>kset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*</td>          <td class="paramname"><span class="paramname"><em>receive_callback&#160;</em></span>)(<a class="el" href="structqsmp__connection__state.html">qsmp_connection_state</a> *, const uint8_t *, size_t), </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*</td>          <td class="paramname"><span class="paramname"><em>disconnect_callback&#160;</em></span>)(<a class="el" href="structqsmp__connection__state.html">qsmp_connection_state</a> *)&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start the IPv4 multi-threaded server. </p>
<p>This function initializes and starts the QSMP server for IPv4 connections using a multi-threaded architecture. It listens on the provided socket and uses the specified QSMP private key for secure key exchange and authentication. Two callback functions are provided:</p><ul>
<li>A receive callback to process incoming client data streams.</li>
<li>A disconnect callback to handle cleanup and resource deallocation when a client disconnects.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">source</td><td>A pointer to the listener socket used by the server. </td></tr>
    <tr><td class="paramname">kset</td><td>[const] A pointer to the QSMP server private signature key used for key exchange. </td></tr>
    <tr><td class="paramname">receive_callback</td><td>A pointer to the function that processes incoming client data. </td></tr>
    <tr><td class="paramname">disconnect_callback</td><td>A pointer to the function that handles client disconnect events.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a QSMP error code indicating the success or failure of starting the IPv4 server. </dd></dl>

</div>
</div>
<a id="a4b1c9dce9b1ecd503785ba6f440e1f8f" name="a4b1c9dce9b1ecd503785ba6f440e1f8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b1c9dce9b1ecd503785ba6f440e1f8f">&#9670;&#160;</a></span>qsmp_server_start_ipv6()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QSMP_EXPORT_API <a class="el" href="qsmp_8h.html#a558f889f6d19c213d49a646d3f733ffd">qsmp_errors</a> qsmp_server_start_ipv6 </td>
          <td>(</td>
          <td class="paramtype">qsc_socket *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structqsmp__server__signature__key.html">qsmp_server_signature_key</a> *</td>          <td class="paramname"><span class="paramname"><em>kset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*</td>          <td class="paramname"><span class="paramname"><em>receive_callback&#160;</em></span>)(<a class="el" href="structqsmp__connection__state.html">qsmp_connection_state</a> *, const uint8_t *, size_t), </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*</td>          <td class="paramname"><span class="paramname"><em>disconnect_callback&#160;</em></span>)(<a class="el" href="structqsmp__connection__state.html">qsmp_connection_state</a> *)&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start the IPv6 multi-threaded server. </p>
<p>This function initializes and starts the QSMP server for IPv6 connections using a multi-threaded design. It listens on the provided IPv6 socket and employs the specified QSMP private key for secure communications. The server uses two callback functions to process incoming client data and handle disconnect events.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">source</td><td>A pointer to the listener socket used by the server. </td></tr>
    <tr><td class="paramname">kset</td><td>[const] A pointer to the QSMP server private signature key used for key exchange and authentication. </td></tr>
    <tr><td class="paramname">receive_callback</td><td>A pointer to the function that processes incoming client data. </td></tr>
    <tr><td class="paramname">disconnect_callback</td><td>A pointer to the function that handles client disconnect events.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a QSMP error code indicating the outcome of starting the IPv6 server. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_c25c037fad2e3d3cc638e43d876bf730.html">QSMP</a></li><li class="navelem"><a class="el" href="server_8h.html">server.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
