\doxysection{C\+:/\+Users/stepp/\+Documents/\+Visual Studio 2022/\+Projects/\+C/\+QSMP/\+QSMP/kex.h File Reference}
\hypertarget{kex_8h}{}\label{kex_8h}\index{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSMP/QSMP/kex.h@{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSMP/QSMP/kex.h}}


QSMP Key Exchange Functions.  


{\ttfamily \#include "{}common.\+h"{}}\newline
{\ttfamily \#include "{}../\+QSMP/qsmp.\+h"{}}\newline
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structqsmp__kex__duplex__client__state}{qsmp\+\_\+kex\+\_\+duplex\+\_\+client\+\_\+state}}
\begin{DoxyCompactList}\small\item\em Internal state for the Duplex key exchange (client-\/side). \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structqsmp__kex__duplex__server__state}{qsmp\+\_\+kex\+\_\+duplex\+\_\+server\+\_\+state}}
\begin{DoxyCompactList}\small\item\em Internal state for the Duplex key exchange (server-\/side). \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structqsmp__kex__simplex__client__state}{qsmp\+\_\+kex\+\_\+simplex\+\_\+client\+\_\+state}}
\begin{DoxyCompactList}\small\item\em Internal state for the Simplex key exchange (client-\/side). \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structqsmp__kex__simplex__server__state}{qsmp\+\_\+kex\+\_\+simplex\+\_\+server\+\_\+state}}
\begin{DoxyCompactList}\small\item\em Internal state for the Simplex key exchange (server-\/side). \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{kex_8h_a9797d9393bdacdfd2d1d4aeed0ac81b7}\label{kex_8h_a9797d9393bdacdfd2d1d4aeed0ac81b7} 
typedef struct qsmp\+\_\+kex\+\_\+duplex\+\_\+client\+\_\+state {\bfseries qsmp\+\_\+kex\+\_\+duplex\+\_\+client\+\_\+state}
\item 
\Hypertarget{kex_8h_abf4ed48b8c8501c8c87a77f1bd7adfc4}\label{kex_8h_abf4ed48b8c8501c8c87a77f1bd7adfc4} 
typedef struct qsmp\+\_\+kex\+\_\+duplex\+\_\+server\+\_\+state {\bfseries qsmp\+\_\+kex\+\_\+duplex\+\_\+server\+\_\+state}
\item 
\Hypertarget{kex_8h_a18cf093f831bc26417fb4e950d8d3dfe}\label{kex_8h_a18cf093f831bc26417fb4e950d8d3dfe} 
typedef struct qsmp\+\_\+kex\+\_\+simplex\+\_\+client\+\_\+state {\bfseries qsmp\+\_\+kex\+\_\+simplex\+\_\+client\+\_\+state}
\item 
\Hypertarget{kex_8h_a7f4d2bdfe4ef9cacd68204129c484048}\label{kex_8h_a7f4d2bdfe4ef9cacd68204129c484048} 
typedef struct qsmp\+\_\+kex\+\_\+simplex\+\_\+server\+\_\+state {\bfseries qsmp\+\_\+kex\+\_\+simplex\+\_\+server\+\_\+state}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{qsmp_8h_a558f889f6d19c213d49a646d3f733ffd}{qsmp\+\_\+errors}} \mbox{\hyperlink{kex_8h_aff1db2cda787bfb2879c04997df5cd58}{qsmp\+\_\+kex\+\_\+duplex\+\_\+server\+\_\+key\+\_\+exchange}} (\mbox{\hyperlink{structqsmp__kex__duplex__server__state}{qsmp\+\_\+kex\+\_\+duplex\+\_\+server\+\_\+state}} \texorpdfstring{$\ast$}{*}kss, \mbox{\hyperlink{structqsmp__connection__state}{qsmp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}cns)
\begin{DoxyCompactList}\small\item\em Execute the server-\/side Duplex key exchange. \end{DoxyCompactList}\item 
\mbox{\hyperlink{qsmp_8h_a558f889f6d19c213d49a646d3f733ffd}{qsmp\+\_\+errors}} \mbox{\hyperlink{kex_8h_ab8863bf4d47f7119408f22bb5740cb11}{qsmp\+\_\+kex\+\_\+duplex\+\_\+client\+\_\+key\+\_\+exchange}} (\mbox{\hyperlink{structqsmp__kex__duplex__client__state}{qsmp\+\_\+kex\+\_\+duplex\+\_\+client\+\_\+state}} \texorpdfstring{$\ast$}{*}kcs, \mbox{\hyperlink{structqsmp__connection__state}{qsmp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}cns)
\begin{DoxyCompactList}\small\item\em Execute the client-\/side Duplex key exchange. \end{DoxyCompactList}\item 
\mbox{\hyperlink{qsmp_8h_a558f889f6d19c213d49a646d3f733ffd}{qsmp\+\_\+errors}} \mbox{\hyperlink{kex_8h_a5b2885a6c289e43ac0b5c14f4c76fb21}{qsmp\+\_\+kex\+\_\+simplex\+\_\+server\+\_\+key\+\_\+exchange}} (\mbox{\hyperlink{structqsmp__kex__simplex__server__state}{qsmp\+\_\+kex\+\_\+simplex\+\_\+server\+\_\+state}} \texorpdfstring{$\ast$}{*}kss, \mbox{\hyperlink{structqsmp__connection__state}{qsmp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}cns)
\begin{DoxyCompactList}\small\item\em Execute the server-\/side Simplex key exchange. \end{DoxyCompactList}\item 
\mbox{\hyperlink{qsmp_8h_a558f889f6d19c213d49a646d3f733ffd}{qsmp\+\_\+errors}} \mbox{\hyperlink{kex_8h_ae9736e127d0d94508b80bd555d3dcb63}{qsmp\+\_\+kex\+\_\+simplex\+\_\+client\+\_\+key\+\_\+exchange}} (\mbox{\hyperlink{structqsmp__kex__simplex__client__state}{qsmp\+\_\+kex\+\_\+simplex\+\_\+client\+\_\+state}} \texorpdfstring{$\ast$}{*}kcs, \mbox{\hyperlink{structqsmp__connection__state}{qsmp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}cns)
\begin{DoxyCompactList}\small\item\em Execute the client-\/side Simplex key exchange. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{kex_8h_af4efcc3a75bf209b53575929b98fa605}{qsmp\+\_\+kex\+\_\+test}} ()
\begin{DoxyCompactList}\small\item\em Run internal tests for the key exchange functions. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
QSMP Key Exchange Functions. 

This header file contains the internal key exchange functions for the Quantum Secure Messaging Protocol (QSMP). QSMP supports two key exchange variants\+:


\begin{DoxyItemize}
\item {\bfseries{Duplex\+:}} A bidirectional key exchange method that enables mutual authentication and secure session key establishment. Both parties exchange cryptographic material to derive a shared secret.
\item {\bfseries{Simplex\+:}} A unidirectional key exchange method where typically the client verifies the server\textquotesingle{}s identity.
\end{DoxyItemize}

The file defines internal state structures for both the client and server roles in Duplex and Simplex key exchanges. These structures encapsulate various cryptographic parameters such as key identities, session token hashes, asymmetric keys (for encryption, signing, and verification), shared secrets, and session expiration times.

The following internal (non-\/exportable) functions are declared\+:


\begin{DoxyItemize}
\item {\ttfamily qsmp\+\_\+kex\+\_\+duplex\+\_\+server\+\_\+key\+\_\+exchange\+:} Executes the server-\/side Duplex key exchange.
\item {\ttfamily qsmp\+\_\+kex\+\_\+duplex\+\_\+client\+\_\+key\+\_\+exchange\+:} Executes the client-\/side Duplex key exchange.
\item {\ttfamily qsmp\+\_\+kex\+\_\+simplex\+\_\+server\+\_\+key\+\_\+exchange\+:} Executes the server-\/side Simplex key exchange.
\item {\ttfamily qsmp\+\_\+kex\+\_\+simplex\+\_\+client\+\_\+key\+\_\+exchange\+:} Executes the client-\/side Simplex key exchange.
\item {\ttfamily qsmp\+\_\+kex\+\_\+test\+:} Runs a suite of internal tests to validate the correctness of the key exchange operations.
\end{DoxyItemize}

\begin{DoxyNote}{Note}
These functions and state structures are internal and are not part of the public QSMP API. 
\end{DoxyNote}


\doxysubsection{Function Documentation}
\Hypertarget{kex_8h_ab8863bf4d47f7119408f22bb5740cb11}\index{kex.h@{kex.h}!qsmp\_kex\_duplex\_client\_key\_exchange@{qsmp\_kex\_duplex\_client\_key\_exchange}}
\index{qsmp\_kex\_duplex\_client\_key\_exchange@{qsmp\_kex\_duplex\_client\_key\_exchange}!kex.h@{kex.h}}
\doxysubsubsection{\texorpdfstring{qsmp\_kex\_duplex\_client\_key\_exchange()}{qsmp\_kex\_duplex\_client\_key\_exchange()}}
{\footnotesize\ttfamily \label{kex_8h_ab8863bf4d47f7119408f22bb5740cb11} 
\mbox{\hyperlink{qsmp_8h_a558f889f6d19c213d49a646d3f733ffd}{qsmp\+\_\+errors}} qsmp\+\_\+kex\+\_\+duplex\+\_\+client\+\_\+key\+\_\+exchange (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structqsmp__kex__duplex__client__state}{qsmp\+\_\+kex\+\_\+duplex\+\_\+client\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{kcs}{, }\item[{\mbox{\hyperlink{structqsmp__connection__state}{qsmp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{cns}{}\end{DoxyParamCaption})}



Execute the client-\/side Duplex key exchange. 

This function initiates and completes the Duplex key exchange from the client side. It processes the server\textquotesingle{}s response, computes the shared secret, and updates the QSMP connection state with the derived cryptographic parameters.


\begin{DoxyParams}{Parameters}
{\em kcs} & A pointer to the duplex client key exchange state structure. \\
\hline
{\em cns} & A pointer to the current QSMP connection state.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a value of type {\ttfamily \doxylink{qsmp_8h_a558f889f6d19c213d49a646d3f733ffd}{qsmp\+\_\+errors}} representing the result of the key exchange operation.
\end{DoxyReturn}
\begin{DoxyNote}{Note}
This is an internal non-\/exportable API. 
\end{DoxyNote}
\Hypertarget{kex_8h_aff1db2cda787bfb2879c04997df5cd58}\index{kex.h@{kex.h}!qsmp\_kex\_duplex\_server\_key\_exchange@{qsmp\_kex\_duplex\_server\_key\_exchange}}
\index{qsmp\_kex\_duplex\_server\_key\_exchange@{qsmp\_kex\_duplex\_server\_key\_exchange}!kex.h@{kex.h}}
\doxysubsubsection{\texorpdfstring{qsmp\_kex\_duplex\_server\_key\_exchange()}{qsmp\_kex\_duplex\_server\_key\_exchange()}}
{\footnotesize\ttfamily \label{kex_8h_aff1db2cda787bfb2879c04997df5cd58} 
\mbox{\hyperlink{qsmp_8h_a558f889f6d19c213d49a646d3f733ffd}{qsmp\+\_\+errors}} qsmp\+\_\+kex\+\_\+duplex\+\_\+server\+\_\+key\+\_\+exchange (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structqsmp__kex__duplex__server__state}{qsmp\+\_\+kex\+\_\+duplex\+\_\+server\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{kss}{, }\item[{\mbox{\hyperlink{structqsmp__connection__state}{qsmp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{cns}{}\end{DoxyParamCaption})}



Execute the server-\/side Duplex key exchange. 

This function processes an incoming Duplex key exchange request on the server side. It uses the server key exchange state ({\ttfamily \doxylink{structqsmp__kex__duplex__server__state}{qsmp\+\_\+kex\+\_\+duplex\+\_\+server\+\_\+state}}) to verify client credentials, exchange the necessary asymmetric keys, and update the QSMP connection state accordingly.


\begin{DoxyParams}{Parameters}
{\em kss} & A pointer to the duplex server key exchange state structure. \\
\hline
{\em cns} & A pointer to the current QSMP connection state.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a value of type {\ttfamily \doxylink{qsmp_8h_a558f889f6d19c213d49a646d3f733ffd}{qsmp\+\_\+errors}} indicating the outcome of the key exchange process.
\end{DoxyReturn}
\begin{DoxyNote}{Note}
This is an internal non-\/exportable API. 
\end{DoxyNote}
\Hypertarget{kex_8h_ae9736e127d0d94508b80bd555d3dcb63}\index{kex.h@{kex.h}!qsmp\_kex\_simplex\_client\_key\_exchange@{qsmp\_kex\_simplex\_client\_key\_exchange}}
\index{qsmp\_kex\_simplex\_client\_key\_exchange@{qsmp\_kex\_simplex\_client\_key\_exchange}!kex.h@{kex.h}}
\doxysubsubsection{\texorpdfstring{qsmp\_kex\_simplex\_client\_key\_exchange()}{qsmp\_kex\_simplex\_client\_key\_exchange()}}
{\footnotesize\ttfamily \label{kex_8h_ae9736e127d0d94508b80bd555d3dcb63} 
\mbox{\hyperlink{qsmp_8h_a558f889f6d19c213d49a646d3f733ffd}{qsmp\+\_\+errors}} qsmp\+\_\+kex\+\_\+simplex\+\_\+client\+\_\+key\+\_\+exchange (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structqsmp__kex__simplex__client__state}{qsmp\+\_\+kex\+\_\+simplex\+\_\+client\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{kcs}{, }\item[{\mbox{\hyperlink{structqsmp__connection__state}{qsmp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{cns}{}\end{DoxyParamCaption})}



Execute the client-\/side Simplex key exchange. 

This function initiates and completes the Simplex key exchange from the client side. It exchanges the necessary cryptographic keys, verifies the server\textquotesingle{}s identity using the remote verification key, and updates the QSMP connection state with the established session parameters.


\begin{DoxyParams}{Parameters}
{\em kcs} & A pointer to the simplex client key exchange state structure. \\
\hline
{\em cns} & A pointer to the current QSMP connection state.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a value of type {\ttfamily \doxylink{qsmp_8h_a558f889f6d19c213d49a646d3f733ffd}{qsmp\+\_\+errors}} representing the outcome of the key exchange process.
\end{DoxyReturn}
\begin{DoxyNote}{Note}
This is an internal non-\/exportable API. 
\end{DoxyNote}
\Hypertarget{kex_8h_a5b2885a6c289e43ac0b5c14f4c76fb21}\index{kex.h@{kex.h}!qsmp\_kex\_simplex\_server\_key\_exchange@{qsmp\_kex\_simplex\_server\_key\_exchange}}
\index{qsmp\_kex\_simplex\_server\_key\_exchange@{qsmp\_kex\_simplex\_server\_key\_exchange}!kex.h@{kex.h}}
\doxysubsubsection{\texorpdfstring{qsmp\_kex\_simplex\_server\_key\_exchange()}{qsmp\_kex\_simplex\_server\_key\_exchange()}}
{\footnotesize\ttfamily \label{kex_8h_a5b2885a6c289e43ac0b5c14f4c76fb21} 
\mbox{\hyperlink{qsmp_8h_a558f889f6d19c213d49a646d3f733ffd}{qsmp\+\_\+errors}} qsmp\+\_\+kex\+\_\+simplex\+\_\+server\+\_\+key\+\_\+exchange (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structqsmp__kex__simplex__server__state}{qsmp\+\_\+kex\+\_\+simplex\+\_\+server\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{kss}{, }\item[{\mbox{\hyperlink{structqsmp__connection__state}{qsmp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{cns}{}\end{DoxyParamCaption})}



Execute the server-\/side Simplex key exchange. 

This function handles the Simplex key exchange on the server side. It processes the client\textquotesingle{}s connection request, validates the provided cryptographic material, and updates the QSMP connection state with the negotiated session parameters.


\begin{DoxyParams}{Parameters}
{\em kss} & A pointer to the simplex server key exchange state structure. \\
\hline
{\em cns} & A pointer to the current QSMP connection state.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a value of type {\ttfamily \doxylink{qsmp_8h_a558f889f6d19c213d49a646d3f733ffd}{qsmp\+\_\+errors}} indicating the success or failure of the key exchange.
\end{DoxyReturn}
\begin{DoxyNote}{Note}
This is an internal non-\/exportable API. 
\end{DoxyNote}
\Hypertarget{kex_8h_af4efcc3a75bf209b53575929b98fa605}\index{kex.h@{kex.h}!qsmp\_kex\_test@{qsmp\_kex\_test}}
\index{qsmp\_kex\_test@{qsmp\_kex\_test}!kex.h@{kex.h}}
\doxysubsubsection{\texorpdfstring{qsmp\_kex\_test()}{qsmp\_kex\_test()}}
{\footnotesize\ttfamily \label{kex_8h_af4efcc3a75bf209b53575929b98fa605} 
bool qsmp\+\_\+kex\+\_\+test (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Run internal tests for the key exchange functions. 

This function executes a suite of internal tests designed to validate the correct operation of the QSMP key exchange mechanisms. The tests include\+:


\begin{DoxyItemize}
\item Verifying the proper initialization and management of state structures for both Duplex and Simplex modes.
\item Testing the cryptographic operations involved in key generation, shared secret derivation, and session token hashing.
\item Ensuring that the key exchange functions correctly update the QSMP connection state.
\end{DoxyItemize}

The function returns true if all internal tests pass, confirming the reliability and correctness of the key exchange implementation.

\begin{DoxyReturn}{Returns}
Returns true if the key exchange tests succeed; otherwise, false.
\end{DoxyReturn}
\begin{DoxyNote}{Note}
This is an internal non-\/exportable API. 
\end{DoxyNote}
